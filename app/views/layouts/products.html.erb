<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Dealkat Retail Data</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="imagetoolbar" content="false" />
    <meta name="viewport" content="width=500" />
    
    <%= stylesheet_link_tag "style", :cache => "styleAll" %>

    <!--[if IE 6]>
    <link rel="stylesheet" media="screen" href="/stylesheets/styleie6.css" />
    <link rel="javascript" media="screen" href="/javascripts/pngfix.js" />
    <style type="text/css">
          img, div, a, input { behavior: url(iepngfix.htc) }
    </style>
    <![endif]-->
    <!--[if IE 7]>
    <link rel="stylesheet" media="screen" href="/stylesheets/styleie7.css" />
    <![endif]-->
    
</head>
<body>
    <div id="wrapper">
        <div id="toplogin">
            <div id="logo"><%= link_to "<span><h1>DealKat.org</h1></span>", "/" %></div><!-- /logo -->
        </div><!-- /toplogin -->
        
	<div id="header">
		<div class="navigation">
			<ul>
				<li><%= link_to "Home", "/" %></li>
				<li><%= link_to "Upload", product_action_path("upload") %></li>
				<li><%= link_to "Download", product_action_path("download") %></li>
				<li><%#= link_to "Search", product_action_path("search") %></li>
				<li><%= link_to "What if?", home_action_path("slider") %></li>
				<li><%= link_to "Analyze", product_action_path("analyze") %></li>
			</ul><!-- /navList -->
		</div><!-- /navigation -->
	</div><!-- /header -->
        
	<div class="contentContainer">
            <div class="formTitle">
                <h3><%= @title %></h3>
                <span><%= @sub_title %></span>
            </div><!-- /formTitle -->
            <div class="error"><%= flash[:notice] %></div>
            <%= yield %>
	</div><!-- /contentContainer -->
        
	<div id="footer">
		<div class="footNavigation">
			<ul>
				<li><%#s= link_to "About", page_path("about") %></li>
				<li><%#= link_to "Contact Us", page_path("contact") %></li>
			</ul>
			<div class="copyight">&copy 2009 DealKat</div>
		</div><!-- /footNavigation -->
                <!--div class="security"><img src="/images/HackerSafeIcon.gif" alt="HackerSafeIcon" width="77" height="36"/><img src="/images/KatsEyesOnlyIcon.gif" alt="KatsEyesOnlyIcon" width="103" height="36"/><img src="/images/HostedbyEngineYard.gif" alt="HostedbyEngineYard" width="62" height="36"/></div-->
	</div><!-- /footer -->
    </div><!-- /wrapper -->
    <%= javascript_include_tag :defaults, :cache => "mainAjax" %>
    <%= javascript_include_tag "compare", "rating", :cache => "mainAll" %>
    <% if request.path == "/" || request.path ==  product_action_path("stream") %>
        <script type="text/javascript">
            var pause = 0;
            var idtimer = 0;
            var id = <%= @id %> ;
            idtimer = setInterval(function(){ pullticker(id+=1);}, 4000);
        //    idtimer = setInterval(function(){ pause_tickers();}, 4000);
            var bindplaypause = function(){ 
              $('#pause').bind('click', function(event){
                document.getElementById('playpause_msg').innerHTML = "Click to play."
                pause_tickers();
              });

              $('#play').bind('click', function(event){
                document.getElementById('playpause_msg').innerHTML = "Click to pause."
                play_tickers();
              });
            }
            bindplaypause();

            function play_tickers()
            {
                if (pause == 1){
                  idtimer = setInterval(function(){ pullticker(id+=1);}, 4000);
                  pause = 0;
                }
            }

            function pause_tickers()
            {
                if (pause == 0){
                  clearInterval(idtimer);
                  pause =1;
                }
            }

            function pullticker(id)
            {
                  //ajax call

                  new Ajax.Request("/products/new_graph/" + id,   
                      {     
                            method:'get',     
                            onSuccess: function(transport){       
                                var response = transport.responseText || "no response text";       
                                  $('#ticker_' + (id-1)).remove();
                                  $(response).insertBefore($('#ticker_' + id));
            //                    alert("Success! \n\n" + response);     
                            },     
                            onFailure: function(){ /*alert('Something went wrong...')*/ }   
                      }
                  );
            }
        </script>

    <% end %>
</body>
</html>