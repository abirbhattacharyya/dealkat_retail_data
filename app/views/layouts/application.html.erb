<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Dealkat Retail Data</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="imagetoolbar" content="false" />
    <meta name="viewport" content="width=500" />
    
    <%= stylesheet_link_tag "style", "ui.theme", "ui.slider", :cache => "styleSlide" %>

    <!--[if IE 6]>
    <link rel="stylesheet" media="screen" href="/stylesheets/styleie6.css" />
    <link rel="javascript" media="screen" href="/javascripts/pngfix.js" />
    <style type="text/css">
          img, div, a, input { behavior: url(iepngfix.htc) }
    </style>
    <![endif]-->
    <!--[if IE 7]>
    <link rel="stylesheet" media="screen" href="/stylesheets/styleie7.css" />
    <![endif]-->
    
</head>
<body>
    <div id="wrapper">
        <div id="toplogin">
            <div id="logo"><%= link_to "<span><h1>DealKat.org</h1></span>", "/" %></div><!-- /logo -->
        </div><!-- /toplogin -->
        
	<div id="header">
		<div class="navigation">
			<ul>
				<li><%= link_to "Home", "/" %></li>
				<li><%= link_to "Upload", product_action_path("upload") %></li>
				<li><%= link_to "Download", product_action_path("download") %></li>
				<li><%#= link_to "Search", product_action_path("search") %></li>
				<li><%= link_to "What if?", home_action_path("slider") %></li>
				<li><%= link_to "Analyze", product_action_path("analyze") %></li>
			</ul><!-- /navList -->
		</div><!-- /navigation -->
	</div><!-- /header -->
        
	<div class="contentContainer">
            <div class="formTitle">
                <h3><%= @title %></h3>
                <span><%= @sub_title %></span>
            </div><!-- /formTitle -->
            <div class="error"><%= flash[:notice] %></div>
            <%= yield %>
	</div><!-- /contentContainer -->
        
	<div id="footer">
		<div class="footNavigation">
			<ul>
				<li><%#= link_to "About", page_path("about") %></li>
				<li><%#= link_to "Contact Us", page_path("contact") %></li>
			</ul>
			<div class="copyight">&copy 2009 DealKat</div>
		</div><!-- /footNavigation -->
                <!--div class="security"><img src="/images/HackerSafeIcon.gif" alt="HackerSafeIcon" width="77" height="36"/><img src="/images/KatsEyesOnlyIcon.gif" alt="KatsEyesOnlyIcon" width="103" height="36"/><img src="/images/HostedbyEngineYard.gif" alt="HostedbyEngineYard" width="62" height="36"/></div-->
	</div><!-- /footer -->
    </div><!-- /wrapper -->
    <%= javascript_include_tag :defaults, :cache => "mainAjax" %>
    <%= javascript_include_tag "jquery-1.3.2", "ui.core", "ui.slider", :cache => "main"  %>
    <% if request.path == home_action_path("slider") %>
        <script type="text/javascript">
                var $j = jQuery.noConflict();
        //      Use jQuery via $j(...)

                $j(document).ready(function(){
                        slider1Min = 1;
                        slider2Min = 1;
                        slider1Max = 100;
                        slider2Max = 100;
                        $j(".slider1").slider({
                                'min': slider1Min,
                                'max': slider1Max,
                                'value': <%= @slider_input1 %>,
                                'slide': function(e, ui){ 
                                        id = document.getElementById('graph_id').innerHTML;
                                        $j('#slider_input1').val(ui.value);
                                        new Ajax.Request("/products/new_slider_graph/" + id,   
                                            {     
                                                  method:'get',     
                                                  onSuccess: function(transport){       
                                                      var response = transport.responseText || "no response text";       
                                                        document.getElementById('graph').innerHTML = response;
        //                                              alert("Success! \n\n" + response);     
                                                  },     
                                                  onFailure: function(){ /*alert('Something went wrong...')*/ }   
                                            }
                                        );
                                }
                        });
                        $j('#slider_input1').blur(function(){
                                var slider1Value = $j("#slider_input1").attr("value"); 
                                if(slider1Value >= slider1Min && slider1Value <= slider1Max){
                                        $j('.slider1').slider('moveTo',slider1Value);
                                        return true;
                                }else{
                                        alert('Please enter a value between '+slider1Min+' and '+slider1Max);
                                        return false;
                                }
                        });

                        $j(".slider2").slider({
                                'min': slider2Min,
                                'max': slider2Max,
                                'value': <%= @slider_input2 %>,
                                'slide': function(e, ui){ 
                                        id = document.getElementById('graph_id').innerHTML;
                                        $j('#slider_input2').val(ui.value);
                                        new Ajax.Request("/products/new_slider_graph/" + id,   
                                            {     
                                                  method:'get',     
                                                  onSuccess: function(transport){       
                                                      var response = transport.responseText || "no response text";       
                                                        document.getElementById('graph').innerHTML = response;
        //                                              alert("Success! \n\n" + response);     
                                                  },     
                                                  onFailure: function(){ /*alert('Something went wrong...')*/ }   
                                            }
                                        );
                                }
                        });
                        $j('#slider_input2').blur(function(){
                                var slider1Value = $j("#slider_input2").attr("value"); 
                                if(slider1Value >= slider2Min && slider1Value <= slider2Max){
                                        $j('.slider2').slider('moveTo',slider1Value);
                                        return true;
                                }else{
                                        alert('Please enter a value between '+slider1Min+' and '+slider1Max);
                                        return false;
                                }
                        });
                });
        </script>
    <% end %>

</body>
</html>